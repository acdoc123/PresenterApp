<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="PresenterApp.MainPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:model="clr-namespace:PresenterApp.Models"
    xmlns:vm="clr-namespace:PresenterApp.ViewModels"
    Title="{Binding Title}"
    x:DataType="vm:MainViewModel">

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>

        <VerticalStackLayout
            Grid.Column="0"
            Padding="10"
            BackgroundColor="{StaticResource Gray100}"
            Spacing="10"
            WidthRequest="250">

            <Button Command="{Binding ToggleNavMenuCommand}" Text="Thêm/ Sửa" />

            <ScrollView IsVisible="{Binding IsNavMenuVisible}">
                <VerticalStackLayout Spacing="15">

                    <Frame Padding="10" CornerRadius="5">
                        <VerticalStackLayout Spacing="5">
                            <Grid ColumnDefinitions="*,Auto">
                                <Label
                                    FontAttributes="Bold"
                                    FontSize="Medium"
                                    Text="Loại sách" />
                                <Button
                                    Grid.Column="1"
                                    Command="{Binding AddNewCommand}"
                                    CommandParameter="BookType"
                                    CornerRadius="20"
                                    HeightRequest="40"
                                    Text="+"
                                    WidthRequest="40" />
                            </Grid>
                            <CollectionView
                                HeightRequest="150"
                                ItemsSource="{Binding BookTypes}"
                                SelectionMode="None">
                                <CollectionView.ItemTemplate>
                                    <DataTemplate x:DataType="model:BookType">
                                        <Label Padding="5" Text="{Binding Name}">
                                            <Label.GestureRecognizers>
                                                <TapGestureRecognizer Command="{Binding Source={RelativeSource AncestorType={x:Type vm:MainViewModel}}, Path=ShowEditPageCommand}" CommandParameter="{Binding}" />
                                            </Label.GestureRecognizers>
                                        </Label>
                                    </DataTemplate>
                                </CollectionView.ItemTemplate>
                            </CollectionView>
                        </VerticalStackLayout>
                    </Frame>

                    <Frame Padding="10" CornerRadius="5">
                        <VerticalStackLayout Spacing="5">
                            <Grid ColumnDefinitions="*,Auto">
                                <Label
                                    FontAttributes="Bold"
                                    FontSize="Medium"
                                    Text="Sách" />
                                <Button
                                    Grid.Column="1"
                                    Command="{Binding AddNewCommand}"
                                    CommandParameter="Book"
                                    CornerRadius="20"
                                    HeightRequest="40"
                                    Text="+"
                                    WidthRequest="40" />
                            </Grid>
                            <CollectionView
                                HeightRequest="150"
                                ItemsSource="{Binding Books}"
                                SelectionMode="None">
                                <CollectionView.ItemTemplate>
                                    <DataTemplate x:DataType="model:Book">
                                        <Label Padding="5" Text="{Binding Name}">
                                            <Label.GestureRecognizers>
                                                <TapGestureRecognizer Command="{Binding Source={RelativeSource AncestorType={x:Type vm:MainViewModel}}, Path=ShowEditPageCommand}" CommandParameter="{Binding}" />
                                            </Label.GestureRecognizers>
                                        </Label>
                                    </DataTemplate>
                                </CollectionView.ItemTemplate>
                            </CollectionView>
                        </VerticalStackLayout>
                    </Frame>

                    <Frame Padding="10" CornerRadius="5">
                        <VerticalStackLayout Spacing="5">
                            <Grid ColumnDefinitions="*,Auto">
                                <Label
                                    FontAttributes="Bold"
                                    FontSize="Medium"
                                    Text="Tag" />
                                <Button
                                    Grid.Column="1"
                                    Command="{Binding AddNewCommand}"
                                    CommandParameter="Tag"
                                    CornerRadius="20"
                                    HeightRequest="40"
                                    Text="+"
                                    WidthRequest="40" />
                            </Grid>
                            <CollectionView
                                HeightRequest="150"
                                ItemsSource="{Binding Tags}"
                                SelectionMode="None">
                                <CollectionView.ItemTemplate>
                                    <DataTemplate x:DataType="model:Tag">
                                        <Label Padding="5" Text="{Binding Name}">
                                            <Label.GestureRecognizers>
                                                <TapGestureRecognizer Command="{Binding Source={RelativeSource AncestorType={x:Type vm:MainViewModel}}, Path=ShowEditPageCommand}" CommandParameter="{Binding}" />
                                            </Label.GestureRecognizers>
                                        </Label>
                                    </DataTemplate>
                                </CollectionView.ItemTemplate>
                            </CollectionView>
                        </VerticalStackLayout>
                    </Frame>

                </VerticalStackLayout>
            </ScrollView>
        </VerticalStackLayout>

        <ContentView
            Grid.Column="1"
            Padding="20"
            Content="{Binding CurrentEditViewModel}">

            <ContentView.Resources />

            <Label
                HorizontalOptions="Center"
                IsVisible="{Binding CurrentEditViewModel, Converter={StaticResource IsNullConverter}}"
                Text="Chọn một mục từ bên trái để chỉnh sửa, hoặc nhấn '+' để thêm mới."
                VerticalOptions="Center" />

        </ContentView>

    </Grid>
</ContentPage>