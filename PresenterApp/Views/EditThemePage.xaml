<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="PresenterApp.Views.EditThemePage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:model="clr-namespace:PresenterApp.Models"
    xmlns:vm="clr-namespace:PresenterApp.ViewModels"
    Title="{Binding Title}"
    x:DataType="vm:EditThemeViewModel">

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="10">

            <Label FontAttributes="Bold" Text="Tên Giao diện chủ đề" />
            <Entry Placeholder="Nhập tên giao diện..." Text="{Binding CurrentTheme.Name}" />

            <Button
                Margin="0,10"
                Command="{Binding LoadFromPptxCommand}"
                Text="Tải thông tin từ file .pptx" />

            <BoxView HeightRequest="1" Color="{StaticResource Gray200}" />

            <Label FontAttributes="Bold" Text="Kích thước Slide" />
            <Picker ItemsSource="{Binding SlideSizes}" SelectedItem="{Binding SelectedSlideSize}" />

            <VerticalStackLayout IsVisible="{Binding IsCustomSize}" Spacing="10">
                <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                    <VerticalStackLayout Grid.Column="0">
                        <Label Text="Width (inch)" />
                        <Entry Keyboard="Numeric" Text="{Binding CustomWidth}" />
                    </VerticalStackLayout>
                    <VerticalStackLayout Grid.Column="1">
                        <Label Text="Height (inch)" />
                        <Entry Keyboard="Numeric" Text="{Binding CustomHeight}" />
                    </VerticalStackLayout>
                </Grid>

                <Label
                    FontAttributes="Italic"
                    FontSize="Small"
                    Text="Width và Height đã định nghĩa hướng slide."
                    TextColor="Gray" />
            </VerticalStackLayout>

            <VerticalStackLayout IsVisible="{Binding IsCustomSize, Converter={StaticResource InvertedBoolConverter}}" Spacing="5">
                <Label FontAttributes="Bold" Text="Hướng Slide" />
                <Picker ItemsSource="{Binding Orientations}" SelectedItem="{Binding SelectedOrientation}" />
            </VerticalStackLayout>


            <Label FontAttributes="Bold" Text="Màu sắc chủ đề" />
            <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                <VerticalStackLayout Grid.Column="0" Spacing="5">
                    <Label Text="Màu nền (Hex: #RRGGBB)" />
                    <Grid ColumnDefinitions="*,Auto" ColumnSpacing="10">
                        <Entry Grid.Column="0" Text="{Binding BackgroundColorHex}" />
                        <Frame
                            Grid.Column="1"
                            BackgroundColor="{Binding BackgroundColorHex}"
                            BorderColor="Gray"
                            HeightRequest="40"
                            WidthRequest="40" />
                    </Grid>
                </VerticalStackLayout>
                <VerticalStackLayout Grid.Column="1" Spacing="5">
                    <Label Text="Màu văn bản (Hex: #RRGGBB)" />
                    <Grid ColumnDefinitions="*,Auto" ColumnSpacing="10">
                        <Entry Grid.Column="0" Text="{Binding TextColorHex}" />
                        <Frame
                            Grid.Column="1"
                            BackgroundColor="{Binding TextColorHex}"
                            BorderColor="Gray"
                            HeightRequest="40"
                            WidthRequest="40" />
                    </Grid>
                </VerticalStackLayout>
            </Grid>
            <Label FontAttributes="Bold" Text="Phông chữ" />
            <Label Text="Phông chữ Tiêu đề" />
            <Picker ItemsSource="{Binding FontList}" SelectedItem="{Binding SelectedTitleFont}" />

            <Label Text="Phông chữ Nội dung" />
            <Picker ItemsSource="{Binding FontList}" SelectedItem="{Binding SelectedContentFont}" />

            <Button
                Margin="0,20,0,0"
                Command="{Binding SaveCommand}"
                HorizontalOptions="Fill"
                Text="Lưu Giao diện" />
            <Button
                BackgroundColor="Red"
                Command="{Binding DeleteCommand}"
                HorizontalOptions="Fill"
                IsVisible="{Binding CurrentTheme.Id, Converter={StaticResource IntToBoolConverter}}"
                Text="Xóa Giao diện" />

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>